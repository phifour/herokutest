{"version":3,"sources":["app/todo/models/montecarlo.ts"],"names":[],"mappings":"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","file":"montecarlo.js","sourcesContent":["import { Option } from \"./option\";\r\nexport class MonteCarlo {\r\n\r\n    public o:Option;\r\n\r\n    constructor(opt:Option) {\r\n        this.o = opt;\r\n    }\r\n\r\n    gaussian(mean, stdev) {\r\n        var y2;\r\n        var use_last = false;\r\n        return function() {\r\n            var y1;\r\n            if(use_last) {\r\n            y1 = y2;\r\n            use_last = false;\r\n            } else {\r\n                var x1, x2, w;\r\n                do {\r\n                    x1 = 2.0 * Math.random() - 1.0;\r\n                    x2 = 2.0 * Math.random() - 1.0;\r\n                    w  = x1 * x1 + x2 * x2;               \r\n                } while( w >= 1.0);\r\n                w = Math.sqrt((-2.0 * Math.log(w))/w);\r\n                y1 = x1 * w;\r\n                y2 = x2 * w;\r\n                use_last = true;\r\n        }\r\n\r\n        var retval = mean + stdev * y1;\r\n        if(retval > 0) {\r\n            return retval;\r\n        } else {\r\n            return -retval;\r\n        }\r\n            \r\n    };\r\n    }\r\n\r\n    public geoBrownian(T:number, N:number) {\r\n    var h = T/N;\r\n    var sqrth = Math.sqrt(h);\r\n    var w = [];\r\n    var grn = this.gaussian(0,1);\r\n    var sum = this.o.S0;\r\n    for (var i=0;i<N;i++) {\r\n      var rn = grn();\r\n      var x = h*i*(this.o.r-0.5*this.o.volatility*this.o.volatility) + rn*this.o.volatility*sqrth;\r\n      sum = sum + x;\r\n    }\r\n    return sum;\r\n    }\r\n\r\n    public geoBrownian_series(T:number, N:number) {\r\n    var h = T/N;\r\n    var sqrth = Math.sqrt(h);\r\n    var w = [];\r\n    var grn = this.gaussian(0,1);\r\n    var sum = this.o.S0;\r\n    var series = [];\r\n\r\n    for (var i=0;i<N;i++) {\r\n      series.push({date:i,close:sum});\r\n      var rn = grn();\r\n      var x = h*i*(this.o.r-0.5*this.o.volatility*this.o.volatility) + rn*this.o.volatility*sqrth;\r\n      sum = sum + x;\r\n    }\r\n    return series;\r\n    }\r\n\r\n    public max(input:number) {\r\n        if (input < 0) {\r\n            return 0;\r\n        } else {\r\n            return input;\r\n        }\r\n    }\r\n\r\n        \r\n    public MonteCarlo(T:number, N:number, Nsteps:number, payoff:any) {\r\n        var profit = [];\r\n        for (var i=0;i<Nsteps;i++) {\r\n            var S_at_T = this.geoBrownian(T, N);\r\n            profit.push(payoff(S_at_T));\r\n            //console.log('S_at_T',S_at_T);\r\n        }\r\n        return profit;\r\n    }\r\n\r\n    public priceOption(T:number, N:number, Nsteps:number, payoff:any) {\r\n        var result = {\r\n            price:0,\r\n            Nsteps:Nsteps\r\n        };\r\n        var profit = [];\r\n        for (var i=0;i<Nsteps;i++) {\r\n            var S_at_T = this.geoBrownian(T, N);\r\n            profit.push(payoff(S_at_T));\r\n            //console.log('S_at_T',S_at_T);\r\n        }\r\n\r\n        var sum = 0;\r\n\r\n        profit.forEach(function(element) {\r\n            sum = sum + element;\r\n        });        \r\n\r\n        result.price = Math.exp(-this.o.r*T)*(sum / profit.length);\r\n        result.Nsteps = Nsteps;\r\n        return result;\r\n    }\r\n\r\n\r\n}\r\n"],"sourceRoot":"/src"}